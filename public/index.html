<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Reversi Mone ðŸ¥Š VS May.C ðŸ‘‹</title>
  <style>
    body { text-align: center; font-family: Arial; }
    table { border-collapse: collapse; margin: 20px auto; }
    td {
      width: 40px; height: 40px;
      background-color: green;
      border: 1px solid #000;
      cursor: pointer;
    }
    .Mone { background-color: deeppink; }
    .MayC { background-color: purple; }
  </style>
</head>
<body>
  <h2>Reversi Mone ðŸ¥Š VS May.C ðŸ‘‹</h2>

  <input type="text" id="nomPartie" value="first" />
  <select id="joueur">
    <option value="Mone">Je suis Mone ðŸ¥Š</option>
    <option value="MayC">Je suis May.C ðŸ‘‹</option>
  </select>
  <button onclick="rejoindre()">Rejoindre la partie</button>
  <a href="#" id="lienWhatsApp" target="_blank">ðŸ“² WhatsApp adversaire</a>

  <p id="info"></p>
  <p id="score"></p>
  <div id="plateau"></div>
  <button onclick="reset()">Rejouer</button>

  <script src="/socket.io/socket.io.js"></script>
  <script>
    const socket = io();
    let nomPartie = "first";
    let joueur = "Mone";

    function rejoindre() {
      nomPartie = document.getElementById('nomPartie').value.trim() || 'first';
      joueur = document.getElementById('joueur').value;
      socket.emit('rejoindrePartie', { nom: nomPartie, joueur });

      const lien = `https://wa.me/?text=Rejoins moi ici : https://${window.location.hostname} (partie: ${nomPartie})`;
      document.getElementById('lienWhatsApp').href = lien;
    }

    socket.on('majPartie', (partie) => {
      document.getElementById('info').innerText = `Vous Ãªtes : ${joueur} ${joueur === 'Mone' ? 'ðŸ¥Š' : 'ðŸ‘‹'} | La partie commence !`;
      document.getElementById('score').innerText = `Score : Mone ðŸ¥Š ${partie.score.Mone} - ${partie.score.MayC} ðŸ‘‹ May.C`;

      const div = document.getElementById('plateau');
      div.innerHTML = '';
      const table = document.createElement('table');

      for (let i = 0; i < 8; i++) {
        const row = document.createElement('tr');
        for (let j = 0; j < 8; j++) {
          const cell = document.createElement('td');
          const val = partie.plateau[i][j];
          if (val) cell.className = val;
          cell.onclick = () => socket.emit('jouerCoup', { nom: nomPartie, x: i, y: j, joueur });
          row.appendChild(cell);
        }
        table.appendChild(row);
      }

      div.appendChild(table);
    });

    function reset() {
      socket.emit('resetPartie', nomPartie);
    }

    socket.on('reset', () => location.reload());
  </script>
</body>
</html>
